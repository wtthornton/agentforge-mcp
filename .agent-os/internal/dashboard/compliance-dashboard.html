<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Compliance Dashboard</title>
    <style>
        * { box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: #f5f5f5; 
            color: #333;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { 
            background: white; 
            padding: 20px; 
            border-radius: 8px; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .score { 
            font-size: 3em; 
            font-weight: bold; 
            text-align: center;
            margin: 20px 0;
        }
        .critical { color: #dc3545; }
        .warning { color: #ffc107; }
        .success { color: #28a745; }
        .info { color: #17a2b8; }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .metric-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .metric-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 10px;
            color: #495057;
        }
        
        .metric-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .violation { 
            margin: 10px 0; 
            padding: 15px; 
            border-left: 4px solid; 
            background: white;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .critical { border-color: #dc3545; background: #f8d7da; }
        .warning { border-color: #ffc107; background: #fff3cd; }
        
        .analytics-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        
        .issue-item {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            border-left: 4px solid #007bff;
        }
        
        .severity-critical { border-left-color: #dc3545; }
        .severity-high { border-left-color: #fd7e14; }
        .severity-medium { border-left-color: #ffc107; }
        .severity-low { border-left-color: #28a745; }
        
        .file-type-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .file-type-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            text-align: center;
        }
        
        .trend-indicator {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.9em;
            font-weight: bold;
        }
        
        .trend-improving { background: #d4edda; color: #155724; }
        .trend-declining { background: #f8d7da; color: #721c24; }
        .trend-stable { background: #d1ecf1; color: #0c5460; }
        
        @media (max-width: 768px) {
            .metrics-grid { grid-template-columns: 1fr; }
            .file-type-stats { grid-template-columns: 1fr; }
        }
        
        .trend-chart {
            width: 100%;
            height: 300px;
            margin: 20px 0;
            position: relative;
        }
        
        .forecast-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .forecast-item {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            backdrop-filter: blur(10px);
        }
        
        .confidence-indicator {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.8em;
            font-weight: bold;
        }
        
        .confidence-high { background: #28a745; color: white; }
        .confidence-medium { background: #ffc107; color: #212529; }
        .confidence-low { background: #dc3545; color: white; }
        
        .timeline-container {
            position: relative;
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .timeline-item {
            display: flex;
            align-items: center;
            margin: 15px 0;
            padding: 10px;
            border-radius: 4px;
            background: #f8f9fa;
            border-left: 4px solid #007bff;
        }
        
        .timeline-date {
            font-weight: bold;
            min-width: 120px;
            color: #495057;
        }
        
        .timeline-content {
            flex: 1;
            margin-left: 15px;
        }
        
        .progress-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            transition: width 0.3s ease;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .comparison-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .comparison-chart {
            width: 100%;
            height: 200px;
            margin: 15px 0;
        }
        
        .period-selector {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .period-btn {
            padding: 8px 16px;
            border: 1px solid #007bff;
            background: white;
            color: #007bff;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .period-btn.active {
            background: #007bff;
            color: white;
        }
        
        .period-btn:hover {
            background: #0056b3;
            color: white;
        }
        
        .insights-panel {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .insight-item {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            backdrop-filter: blur(10px);
        }
        
        .priority-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .priority-high { background: #dc3545; color: white; }
        .priority-medium { background: #ffc107; color: #212529; }
        .priority-low { background: #28a745; color: white; }
        
        @media (max-width: 768px) {
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            .comparison-grid {
                grid-template-columns: 1fr;
            }
            .period-selector {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Enhanced Compliance Dashboard</h1>
            <p>Real-time analytics and trend analysis for Agent OS framework compliance</p>
        </div>

        <!-- Enhanced Trend Analysis Section -->
        <div class="analytics-section">
            <h2>ðŸ“ˆ Trend Analysis & Forecasting</h2>
            
            <!-- Trend Charts -->
            <div class="chart-container">
                <h3>Compliance Score Trends</h3>
                <div class="trend-chart">
                    <canvas id="complianceTrendChart"></canvas>
                </div>
                <div class="trend-indicator" id="complianceTrendIndicator"></div>
            </div>
            
            <div class="chart-container">
                <h3>Violation Count Trends</h3>
                <div class="trend-chart">
                    <canvas id="violationTrendChart"></canvas>
                </div>
                <div class="trend-indicator" id="violationTrendIndicator"></div>
            </div>
            
            <div class="chart-container">
                <h3>Performance Metrics Trends</h3>
                <div class="trend-chart">
                    <canvas id="performanceTrendChart"></canvas>
                </div>
                <div class="trend-indicator" id="performanceTrendIndicator"></div>
            </div>
        </div>

        <!-- Enhanced Forecast Section -->
        <div class="forecast-section">
            <h2>ðŸ”® Predictive Analytics & Forecasting</h2>
            <div id="forecastContainer"></div>
        </div>

        <!-- Enhanced Timeline Visualization -->
        <div class="timeline-container">
            <h2>ðŸ“… Violation Timeline & Historical Analysis</h2>
            <div id="timelineContainer"></div>
        </div>

        <!-- Enhanced Progress Tracking -->
        <div class="progress-section">
            <h2>ðŸ“Š Progress Tracking & Improvement Metrics</h2>
            <div id="progressContainer"></div>
        </div>

        <!-- Enhanced Trend Comparison -->
        <div class="comparison-grid">
            <div class="comparison-card">
                <h3>Period-to-Period Comparison</h3>
                <div class="period-selector">
                    <button class="period-btn active" data-period="7">Last 7 Days</button>
                    <button class="period-btn" data-period="14">Last 14 Days</button>
                    <button class="period-btn" data-period="30">Last 30 Days</button>
                </div>
                <div class="comparison-chart">
                    <canvas id="comparisonChart"></canvas>
                </div>
            </div>
            
            <div class="comparison-card">
                <h3>Trend Indicators & Analysis</h3>
                <div id="trendIndicators"></div>
            </div>
        </div>

        <!-- Enhanced Insights Panel -->
        <div class="insights-panel">
            <h2>ðŸ’¡ Smart Insights & Recommendations</h2>
            <div id="insightsContainer"></div>
        </div>

        <!-- Original Dashboard Content -->
        <div id="complianceScore" class="score"></div>
        
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-title">Total Violations</div>
                <div class="metric-value" id="totalViolations"></div>
            </div>
            <div class="metric-card">
                <div class="metric-title">Critical Violations</div>
                <div class="metric-value" id="criticalViolations"></div>
            </div>
            <div class="metric-card">
                <div class="metric-title">Execution Time</div>
                <div class="metric-value" id="executionTime"></div>
            </div>
            <div class="metric-card">
                <div class="metric-title">Files Processed</div>
                <div class="metric-value" id="filesProcessed"></div>
            </div>
        </div>

        <div id="violations"></div>
        <div id="analytics"></div>
        <div id="issues"></div>
    </div>

    <script>
        // Enhanced Trend Analysis and Visualization
        class EnhancedTrendVisualization {
            constructor() {
                this.charts = {};
                this.currentData = null;
                this.initializeCharts();
            }

            initializeCharts() {
                this.createComplianceTrendChart();
                this.createViolationTrendChart();
                this.createPerformanceTrendChart();
                this.createComparisonChart();
            }

            createComplianceTrendChart() {
                const canvas = document.getElementById('complianceTrendChart');
                const ctx = canvas.getContext('2d');
                
                // Set canvas size
                canvas.width = canvas.offsetWidth;
                canvas.height = 300;
                
                this.charts.compliance = { canvas, ctx };
            }

            createViolationTrendChart() {
                const canvas = document.getElementById('violationTrendChart');
                const ctx = canvas.getContext('2d');
                
                canvas.width = canvas.offsetWidth;
                canvas.height = 300;
                
                this.charts.violations = { canvas, ctx };
            }

            createPerformanceTrendChart() {
                const canvas = document.getElementById('performanceTrendChart');
                const ctx = canvas.getContext('2d');
                
                canvas.width = canvas.offsetWidth;
                canvas.height = 300;
                
                this.charts.performance = { canvas, ctx };
            }

            createComparisonChart() {
                const canvas = document.getElementById('comparisonChart');
                const ctx = canvas.getContext('2d');
                
                canvas.width = canvas.offsetWidth;
                canvas.height = 200;
                
                this.charts.comparison = { canvas, ctx };
            }

            drawTrendChart(chartData, chartType) {
                const chart = this.charts[chartType];
                if (!chart) return;

                const { canvas, ctx } = chart;
                const width = canvas.width;
                const height = canvas.height;
                const padding = 40;

                // Clear canvas
                ctx.clearRect(0, 0, width, height);

                if (!chartData || chartData.length < 2) {
                    this.drawNoDataMessage(ctx, width, height);
                    return;
                }

                // Calculate scales
                const dataWidth = width - 2 * padding;
                const dataHeight = height - 2 * padding;
                
                const minValue = Math.min(...chartData.map(d => d.value));
                const maxValue = Math.max(...chartData.map(d => d.value));
                const valueRange = maxValue - minValue || 1;

                // Draw grid
                this.drawGrid(ctx, width, height, padding, chartData.length, minValue, maxValue);

                // Draw trend line
                this.drawTrendLine(ctx, chartData, padding, dataWidth, dataHeight, minValue, valueRange);

                // Draw data points
                this.drawDataPoints(ctx, chartData, padding, dataWidth, dataHeight, minValue, valueRange);

                // Draw labels
                this.drawLabels(ctx, width, height, padding, chartData, minValue, maxValue);
            }

            drawGrid(ctx, width, height, padding, dataPoints, minValue, maxValue) {
                ctx.strokeStyle = '#e0e0e0';
                ctx.lineWidth = 1;

                // Vertical grid lines
                for (let i = 0; i <= dataPoints; i++) {
                    const x = padding + (i / dataPoints) * (width - 2 * padding);
                    ctx.beginPath();
                    ctx.moveTo(x, padding);
                    ctx.lineTo(x, height - padding);
                    ctx.stroke();
                }

                // Horizontal grid lines
                const gridLines = 5;
                for (let i = 0; i <= gridLines; i++) {
                    const y = padding + (i / gridLines) * (height - 2 * padding);
                    ctx.beginPath();
                    ctx.moveTo(padding, y);
                    ctx.lineTo(width - padding, y);
                    ctx.stroke();
                }
            }

            drawTrendLine(ctx, data, padding, dataWidth, dataHeight, minValue, valueRange) {
                ctx.strokeStyle = '#007bff';
                ctx.lineWidth = 3;
                ctx.beginPath();

                data.forEach((point, index) => {
                    const x = padding + (index / (data.length - 1)) * dataWidth;
                    const y = padding + dataHeight - ((point.value - minValue) / valueRange) * dataHeight;
                    
                    if (index === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });

                ctx.stroke();
            }

            drawDataPoints(ctx, data, padding, dataWidth, dataHeight, minValue, valueRange) {
                ctx.fillStyle = '#007bff';
                ctx.strokeStyle = '#ffffff';
                ctx.lineWidth = 2;

                data.forEach((point, index) => {
                    const x = padding + (index / (data.length - 1)) * dataWidth;
                    const y = padding + dataHeight - ((point.value - minValue) / valueRange) * dataHeight;
                    
                    ctx.beginPath();
                    ctx.arc(x, y, 6, 0, 2 * Math.PI);
                    ctx.fill();
                    ctx.stroke();
                });
            }

            drawLabels(ctx, width, height, padding, data, minValue, maxValue) {
                ctx.fillStyle = '#333';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';

                // X-axis labels
                data.forEach((point, index) => {
                    const x = padding + (index / (data.length - 1)) * (width - 2 * padding);
                    const y = height - 10;
                    ctx.fillText(point.label || index.toString(), x, y);
                });

                // Y-axis labels
                ctx.textAlign = 'right';
                const gridLines = 5;
                for (let i = 0; i <= gridLines; i++) {
                    const y = padding + (i / gridLines) * (height - 2 * padding);
                    const value = minValue + (i / gridLines) * (maxValue - minValue);
                    ctx.fillText(value.toFixed(1), padding - 10, y + 4);
                }
            }

            drawNoDataMessage(ctx, width, height) {
                ctx.fillStyle = '#999';
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('No data available', width / 2, height / 2);
            }

            updateTrendIndicators(data) {
                if (!data || !data.trendAnalysis) return;

                const indicators = {
                    compliance: document.getElementById('complianceTrendIndicator'),
                    violations: document.getElementById('violationTrendIndicator'),
                    performance: document.getElementById('performanceTrendIndicator')
                };

                Object.entries(indicators).forEach(([type, element]) => {
                    if (element && data.trendAnalysis[type]) {
                        const trend = data.trendAnalysis[type];
                        element.textContent = `${trend.trendDirection} (${trend.trend.toFixed(2)})`;
                        element.className = `trend-indicator trend-${trend.trendDirection.toLowerCase()}`;
                    }
                });
            }

            updateForecastVisualization(forecastData) {
                const container = document.getElementById('forecastContainer');
                if (!container || !forecastData) return;

                let html = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">';
                
                forecastData.forecasts.forEach(forecast => {
                    html += `
                        <div class="forecast-item">
                            <h4>${forecast.metric}</h4>
                            <p><strong>Current:</strong> ${forecast.currentValue}</p>
                            <p><strong>Forecast:</strong> ${forecast.forecast.join(' â†’ ')}</p>
                            <p><strong>Trend:</strong> ${forecast.trend > 0 ? 'â†—' : forecast.trend < 0 ? 'â†˜' : 'â†’'} ${forecast.trend.toFixed(2)}</p>
                            <span class="confidence-indicator confidence-${forecast.confidence.toLowerCase()}">${forecast.confidence} Confidence</span>
                            <p><small>${forecast.recommendation}</small></p>
                        </div>
                    `;
                });
                
                html += '</div>';
                container.innerHTML = html;
            }

            updateTimelineVisualization(timelineData) {
                const container = document.getElementById('timelineContainer');
                if (!container || !timelineData) return;

                let html = '';
                timelineData.forEach(item => {
                    html += `
                        <div class="timeline-item">
                            <div class="timeline-date">${item.date}</div>
                            <div class="timeline-content">
                                <strong>${item.title}</strong>
                                <p>${item.description}</p>
                                <span class="priority-badge priority-${item.priority.toLowerCase()}">${item.priority}</span>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            }

            updateProgressTracking(progressData) {
                const container = document.getElementById('progressContainer');
                if (!container || !progressData) return;

                let html = `
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div class="metric-card">
                            <h4>Overall Compliance Progress</h4>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${progressData.overallProgress}%"></div>
                            </div>
                            <p>${progressData.overallProgress}% Complete</p>
                        </div>
                        <div class="metric-card">
                            <h4>Standards Compliance</h4>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${progressData.standardsProgress}%"></div>
                            </div>
                            <p>${progressData.standardsProgress}% Complete</p>
                        </div>
                        <div class="metric-card">
                            <h4>Performance Optimization</h4>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${progressData.performanceProgress}%"></div>
                            </div>
                            <p>${progressData.performanceProgress}% Complete</p>
                        </div>
                    </div>
                `;
                
                container.innerHTML = html;
            }

            updateTrendComparison(comparisonData) {
                const container = document.getElementById('trendIndicators');
                if (!container || !comparisonData) return;

                let html = '';
                Object.entries(comparisonData).forEach(([metric, data]) => {
                    html += `
                        <div style="margin: 15px 0; padding: 15px; background: #f8f9fa; border-radius: 4px;">
                            <h5>${metric}</h5>
                            <p><strong>Current Period:</strong> ${data.current}</p>
                            <p><strong>Previous Period:</strong> ${data.previous}</p>
                            <p><strong>Change:</strong> <span class="trend-indicator trend-${data.change > 0 ? 'improving' : data.change < 0 ? 'declining' : 'stable'}">${data.change > 0 ? '+' : ''}${data.change}%</span></p>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            }

            updateInsightsPanel(insightsData) {
                const container = document.getElementById('insightsContainer');
                if (!container || !insightsData) return;

                let html = '';
                insightsData.forEach(insight => {
                    html += `
                        <div class="insight-item">
                            <h4>${insight.title}</h4>
                            <p>${insight.description}</p>
                            <span class="priority-badge priority-${insight.priority.toLowerCase()}">${insight.priority}</span>
                            <ul style="margin-top: 10px;">
                                ${insight.actions.map(action => `<li>${action}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            }

            loadAndVisualizeData() {
                // Simulate loading data from the statistical analysis
                this.loadHistoricalData().then(data => {
                    this.currentData = data;
                    this.updateAllVisualizations(data);
                });
            }

            async loadHistoricalData() {
                // This would normally load from the statistical analysis module
                // For now, we'll create sample data
                return {
                    complianceScores: [
                        { date: '2024-01-01', value: 75, label: 'Day 1' },
                        { date: '2024-01-02', value: 78, label: 'Day 2' },
                        { date: '2024-01-03', value: 82, label: 'Day 3' },
                        { date: '2024-01-04', value: 85, label: 'Day 4' },
                        { date: '2024-01-05', value: 88, label: 'Day 5' }
                    ],
                    violationCounts: [
                        { date: '2024-01-01', value: 15, label: 'Day 1' },
                        { date: '2024-01-02', value: 12, label: 'Day 2' },
                        { date: '2024-01-03', value: 10, label: 'Day 3' },
                        { date: '2024-01-04', value: 8, label: 'Day 4' },
                        { date: '2024-01-05', value: 6, label: 'Day 5' }
                    ],
                    performanceMetrics: [
                        { date: '2024-01-01', value: 1200, label: 'Day 1' },
                        { date: '2024-01-02', value: 1150, label: 'Day 2' },
                        { date: '2024-01-03', value: 1100, label: 'Day 3' },
                        { date: '2024-01-04', value: 1050, label: 'Day 4' },
                        { date: '2024-01-05', value: 1000, label: 'Day 5' }
                    ],
                    trendAnalysis: {
                        compliance: { trendDirection: 'IMPROVING', trend: 3.25 },
                        violations: { trendDirection: 'DECLINING', trend: -2.25 },
                        performance: { trendDirection: 'IMPROVING', trend: -50 }
                    },
                    forecastData: {
                        forecasts: [
                            {
                                metric: 'Compliance Score',
                                currentValue: 88,
                                forecast: [90, 92, 94],
                                trend: 3.25,
                                confidence: 'HIGH',
                                recommendation: 'Continue current improvement practices'
                            },
                            {
                                metric: 'Violation Count',
                                currentValue: 6,
                                forecast: [5, 4, 3],
                                trend: -2.25,
                                confidence: 'HIGH',
                                recommendation: 'Maintain current violation reduction strategies'
                            }
                        ]
                    },
                    timelineData: [
                        {
                            date: '2024-01-05',
                            title: 'Compliance Score Improved',
                            description: 'Compliance score increased to 88%',
                            priority: 'HIGH'
                        },
                        {
                            date: '2024-01-04',
                            title: 'Violation Count Reduced',
                            description: 'Total violations reduced to 8',
                            priority: 'MEDIUM'
                        }
                    ],
                    progressData: {
                        overallProgress: 85,
                        standardsProgress: 90,
                        performanceProgress: 80
                    },
                    comparisonData: {
                        'Compliance Score': { current: 88, previous: 85, change: 3.5 },
                        'Violation Count': { current: 6, previous: 8, change: -25 },
                        'Performance': { current: 1000, previous: 1050, change: -4.8 }
                    },
                    insightsData: [
                        {
                            title: 'Maintain Improvement Momentum',
                            description: 'Compliance is showing consistent improvement',
                            priority: 'HIGH',
                            actions: [
                                'Continue current improvement practices',
                                'Document successful strategies',
                                'Share best practices across team'
                            ]
                        },
                        {
                            title: 'Optimize Performance Further',
                            description: 'Performance metrics are improving but can be optimized',
                            priority: 'MEDIUM',
                            actions: [
                                'Review performance bottlenecks',
                                'Implement additional optimizations',
                                'Monitor performance trends'
                            ]
                        }
                    ]
                };
            }

            updateAllVisualizations(data) {
                // Update trend charts
                this.drawTrendChart(data.complianceScores, 'compliance');
                this.drawTrendChart(data.violationCounts, 'violations');
                this.drawTrendChart(data.performanceMetrics, 'performance');
                
                // Update indicators
                this.updateTrendIndicators(data);
                
                // Update other visualizations
                this.updateForecastVisualization(data.forecastData);
                this.updateTimelineVisualization(data.timelineData);
                this.updateProgressTracking(data.progressData);
                this.updateTrendComparison(data.comparisonData);
                this.updateInsightsPanel(data.insightsData);
            }
        }

        // Initialize enhanced visualization
        const enhancedViz = new EnhancedTrendVisualization();
        enhancedViz.loadAndVisualizeData();

        // Period selector functionality
        document.querySelectorAll('.period-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.period-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                // Update comparison chart based on selected period
                const period = this.dataset.period;
                enhancedViz.updateComparisonForPeriod(period);
            });
        });

        // Auto-refresh dashboard every 30 seconds
        setTimeout(() => {
            window.location.reload();
        }, 30000);
        
        // Add interactive features
        document.addEventListener('DOMContentLoaded', function() {
            // Add click handlers for expandable sections
            const sections = document.querySelectorAll('.analytics-section');
            sections.forEach(section => {
                const title = section.querySelector('h2');
                if (title) {
                    title.style.cursor = 'pointer';
                    title.addEventListener('click', () => {
                        const content = section.querySelectorAll('div:not(:first-child)');
                        content.forEach(el => {
                            el.style.display = el.style.display === 'none' ? 'block' : 'none';
                        });
                    });
                }
            });
        });
    </script>
</body>
</html>